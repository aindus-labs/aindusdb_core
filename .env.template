# AindusDB Core - Configuration Template
# Copiez ce fichier vers .env et adaptez les valeurs

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
POSTGRES_PASSWORD=aindusdb_secure_2026_change_me
POSTGRES_PORT=5432
DATABASE_URL=postgresql://aindusdb:${POSTGRES_PASSWORD}@localhost:5432/aindusdb_core

# =============================================================================
# API CONFIGURATION
# =============================================================================
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4
API_TITLE="AindusDB Core API"
API_VERSION=1.0.0

# =============================================================================
# SECURITY
# =============================================================================
# ‚ö†Ô∏è  ATTENTION : Ce fichier contient des valeurs de d√©monstration SEULEMENT
#    Ne JAMAIS utiliser en production! G√©n√©rer vos propres secrets.

# ==========================================
# üîê CONFIGURATION S√âCURIT√â DURCIE
# ==========================================

# Environnement (development, staging, production)
ENVIRONMENT=development

# --- Configuration CORS ---
# ‚ö†Ô∏è  En production, sp√©cifier les domaines EXACTS, pas de wildcards!
#    Exemple: CORS_ORIGINS=https://app.yourdomain.com,https://admin.yourdomain.com
CORS_ORIGINS=http://localhost:3000,http://localhost:8080
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOW_HEADERS=Authorization,Content-Type,X-Requested-With
CORS_ALLOW_CREDENTIALS=false
CORS_MAX_AGE=86400

# --- Configuration SSL/TLS ---
# ‚ö†Ô∏è  TOUJOURS activer en production!
SSL_ENABLED=false
SSL_CERT_PATH=/etc/ssl/certs/aindusdb.crt
SSL_KEY_PATH=/etc/ssl/private/aindusdb.key
SSL_CA_PATH=/etc/ssl/certs/ca.crt
TLS_VERSION=TLSv1.3
FORCE_HTTPS=false

# --- Headers de S√©curit√© ---
SECURITY_HEADERS_ENABLED=true
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true
# ‚ö†Ô∏è  En production, enlever 'unsafe-inline'!
CONTENT_SECURITY_POLICY=default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; frame-ancestors 'none'; base-uri 'self'; form-action 'self'

# --- Rate Limiting ---
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_BURST=10
RATE_LIMIT_STORAGE=redis

# --- Configuration JWT ---
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=15
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7
JWT_ISSUER=aindusdb-core
JWT_AUDIENCE=aindusdb-users

# --- Configuration Session ---
SESSION_TIMEOUT_MINUTES=30
MAX_CONCURRENT_SESSIONS=3
SECURE_COOKIES=true
COOKIE_SAMESITE=Strict

# --- Validation des Entr√©es ---
MAX_REQUEST_SIZE_MB=10
MAX_FILE_SIZE_MB=5
ALLOWED_FILE_TYPES=.txt,.pdf,.doc,.docx,.png,.jpg,.jpeg,.gif

# --- Audit et Logging ---
AUDIT_ENABLED=true
AUDIT_RETENTION_DAYS=90
AUDIT_SENSITIVE_OPERATIONS=true
LOG_FAILED_AUTH=true
LOG_DATA_ACCESS=true

# --- Monitoring S√©curit√© ---
SECURITY_MONITORING_ENABLED=true
ALERT_ON_FAILED_ATTEMPTS=5
ALERT_ON_SUSPICIOUS_PATTERNS=true
BLOCK_SUSPICIOUS_IPS=true
IP_BLOCK_DURATION_MINUTES=60

# --- Backup S√©curis√© ---
BACKUP_ENCRYPTION_ENABLED=true
BACKUP_RETENTION_DAYS=30
BACKUP_VERIFY_CHECKSUMS=true

# =============================================================================
# EMBEDDINGS CONFIGURATION
# =============================================================================
# Mod√®les d'embeddings par modalit√©
EMBEDDING_MODEL_TEXT=sentence-transformers/all-MiniLM-L6-v2
EMBEDDING_MODEL_IMAGE=openai/clip-vit-base-patch32
EMBEDDING_MODEL_AUDIO=laion/clap-htsat-fused
EMBEDDING_MODEL_VIDEO=openai/clip-vit-base-patch32
EMBEDDING_MODEL_3D=pointnet_custom

# Dimensions des embeddings
EMBEDDING_DIMENSIONS_TEXT=384
EMBEDDING_DIMENSIONS_IMAGE=512
EMBEDDING_DIMENSIONS_AUDIO=512
EMBEDDING_DIMENSIONS_VIDEO=512
EMBEDDING_DIMENSIONS_3D=256

# =============================================================================
# PERFORMANCE & LIMITS
# =============================================================================
MAX_DOCUMENT_SIZE=10485760  # 10MB
MAX_BATCH_SIZE=100
SEARCH_RESULTS_LIMIT=1000
CONNECTION_POOL_SIZE=20
CONNECTION_POOL_MAX_OVERFLOW=30

# Index HNSW parameters
HNSW_M=32
HNSW_EF_CONSTRUCTION=128
HNSW_EF_SEARCH=64

# =============================================================================
# REDIS CACHE (Optional)
# =============================================================================
REDIS_URL=redis://localhost:6379/0
REDIS_PORT=6379
REDIS_PASSWORD=
CACHE_TTL=3600  # 1 hour

# =============================================================================
# MONITORING (Optional)
# =============================================================================
PROMETHEUS_PORT=9090
METRICS_ENABLED=true
LOG_LEVEL=INFO
LOG_FORMAT=json

# =============================================================================
# MULTI-TENANT
# =============================================================================
MULTI_TENANT_ENABLED=true
DEFAULT_TENANT=default
TENANT_ISOLATION=RLS  # Row Level Security

# =============================================================================
# FILE UPLOAD
# =============================================================================
UPLOAD_MAX_SIZE=50485760  # 50MB
UPLOAD_ALLOWED_TYPES=pdf,txt,docx,png,jpg,jpeg,gif,mp3,wav,mp4,avi,obj,stl
UPLOAD_DIRECTORY=./uploads

# =============================================================================
# SEARCH CONFIGURATION
# =============================================================================
# Recherche hybride (vectorielle + BM25)
HYBRID_SEARCH_ENABLED=true
BM25_WEIGHT=0.3
VECTOR_WEIGHT=0.7
RRF_K=60  # Reciprocal Rank Fusion parameter

# Full-text search
FTS_LANGUAGE=french
FTS_CONFIG=pg_catalog.french

# =============================================================================
# DEVELOPMENT
# =============================================================================
DEBUG=false
RELOAD=false
ENVIRONMENT=production
